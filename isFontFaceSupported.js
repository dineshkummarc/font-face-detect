

/*!
 * isFontFaceSupported - v0.1 - 8/19/2009
 * 
 * Copyright (c) 2009 Paul Irish
 * MIT license
  */


function isFontFaceSupported(){

  // IE supports EOT. 
  //   It has had EOT since IE 5.
  // So we sniff. 
  if (!(!/*@cc_on!@*/0)) return true;
  
  var doc = document,
      b   = doc.body,
      st  = doc.createElement('style'),
      spn = doc.createElement('span'),
      wid, nwid;
      
  st.textContent = "@font-face { font-family: testfont; src: url(data:font/ttf;base64,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AGkAYwAgAGQAbwBtAGEAaQBuAC4AIABBACAALgBzAGYAZAAgAHYAZQByAHMAaQBvAG4AIABvAGYAIAB0AGgAZQAgAGYAbwBuAHQAIABpAHMAIABhAGwAcwBvACAAYQB2AGEAaQBsAGkAYQBiAGwAZQAuACAAagBhAG0AZQBzAC4AawBpAGwAZgBpAGcAZQByAEAAZwBtAGEAaQBsAC4AYwBvAG0AMgA2AGYAOAAzADEANgAwADcAOQAzADMAOQAwAGEAMgAgAC0AIABzAHUAYgBzAGUAdAAgAG8AZgAgAEEAbABwAGgAYQBiAGUAdABvAGYAQwBoAGkAbABkAHIAZQBuAE0AZQBkAGkAdQBtADIANgBmADgAMwAxADYAMAA3ADkAMwAzADkAMABhADIAIAAtACAAcwB1AGIAcwBlAHQAIABvAGYAIABGAG8AbgB0AEYAbwByAGcAZQAgADoAIABBAGwAcABoAGEAYgBlAHQAIABvAGYAIABDAGgAaQBsAGQAcgBlAG4AIAA6ACAAMgAwAC0AMQAxAC0AMgAwADAANgAyADYAZgA4ADMAMQA2ADAANwA5ADMAMwA5ADAAYQAyACAALQAgAHMAdQBiAHMAZQB0ACAAbwBmACAAQQBsAHAAaABhAGIAZQB0ACAAbwBmACAAQwBoAGkAbABkAHIAZQBuAFYAZQByAHMAaQBvAG4AIAAwADAAMQAuADAAMAAwACAAMgA2AGYAOAAzADEANgAwADcAOQAzADMAOQAwAGEAMgAgAC0AIABzAHUAYgBzAGUAdAAgAG8AZgAgAEEAbABwAGgAYQBiAGUAdABvAGYAQwBoAGkAbABkAHIAZQBuAAAAAgAAAAAAAP47AOEAAAABAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQACAAMAUABaAAA=)}";
  
  spn.style.cssText = 'font-family: monospace, position: absolute, top: -9999px, left: -9999px, visibility : hidden';
  
  // the data-uri'd font only has the m and w glyphs.
  spn.innerHTML = 'wwmmwwmmwmwmwwmwmwmwm';
  spn.id        = 'fonttest';
  
  b.appendChild(st);
  b.appendChild(spn);
  
  wid = spn.offsetWidth;
  spn.style.fontFamily = 'testfont,monospace';
  nwid = spn.offsetWidth;
  
  b.removeChild(st);
  b.removeChild(spn);
  
  return wid !== nwid;
}
